"use strict";(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[1846],{1846:(Q,x,s)=>{s.r(x),s.d(x,{ProfilePage:()=>ae});var e=s(74081),d=s(27279),A=s(51926),I=s(73354),T=s(27875),j=s(74758),M=s(48102),m=s(93415),_=s(10701),y=s(21395),R=s(23298),g=s(74577),X=s(12881),J=s(28040),P=s(63738),i=s(1180),V=s(59082),K=s(98264),w=s(92191),Y=s(71563),k=s(51943),Z=s(364),C=s(61020),U=s(40464),F=s(72450),q=s(47853),N=s(92401),G=s(44328),ee=s(8291),Ie=s(15816),Te=s(97442),je=s(13576),ye=s(87830),Ce=s(47184),Re=s(49402),Ue=s(49204),Se=s(75719),Be=s(74919),We=s(29206),Ke=s(98934),we=s(43433),Ze=s(64797),Fe=s(85811),Ne=s(8175);const se=q.Ry().shape(ee.s),ae=()=>{const{changeLocale:t,localeNames:l}=(0,N.M)(),{setUserDisplayName:c}=(0,i.useAppInfo)(),{formatMessage:o}=(0,C.Z)(),{trackUsage:n}=(0,i.useTracking)(),u=(0,i.useNotification)(),{lockApp:r,unlockApp:O}=(0,i.useOverlayBlocker)(),{notifyStatus:D}=(0,A.G)(),{currentTheme:L,themes:oe,onChangeTheme:ie}=(0,N.P)(),{get:z,put:de}=(0,i.useFetchClient)();(0,i.useFocusWhenNavigate)();const{isLoading:le,data:v,refetch:ce}=(0,U.useQuery)("user",async()=>{const{data:a}=await z("/admin/users/me");return a.data},{onSuccess(){D(o({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){u({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:me,data:_e}=(0,U.useQuery)(["providers","isSSOLocked"],async()=>{const{data:{data:a}}=await z("/admin/providers/isSSOLocked");return a},{enabled:window.strapi.isEE&&window.strapi.features.isEnabled("sso"),onError(){u({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),ge=le||me,H=(0,U.useMutation)(async a=>{const{confirmPassword:h,currentTheme:p,...E}=a,{data:f}=await de("/admin/users/me",E);return{...f.data,currentTheme:p}},{async onSuccess(a){await ce();const{email:h,firstname:p,lastname:E,username:f,preferedLanguage:S}=a;i.auth.setUserInfo({email:h,firstname:p,lastname:E,username:f,preferedLanguage:S});const B=a.username||(0,G.g)(a.firstname??"",a.lastname);c(B),a.preferedLanguage&&t(a.preferedLanguage),ie(a.currentTheme),n("didChangeMode",{newMode:a.currentTheme}),u({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},async onSettled(){O()}}),{isLoading:ue}=H,fe=async(a,{setErrors:h})=>{r();const p=a.username;H.mutate({...a,username:p},{onError(E){const f=E?.response?.data;return f?.data?h(f.data):u({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(ge||!v)return(0,e.jsxs)(I.o,{"aria-busy":"true",children:[(0,e.jsx)(Z.q,{title:o({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(T.T,{title:o({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),(0,e.jsx)(j.D,{children:(0,e.jsx)(i.LoadingIndicatorPage,{})})]});const pe=_e?.isSSOLocked??!1,{email:Ee,firstname:he,lastname:Me,username:Pe,preferedLanguage:Oe}=v,De={email:Ee,firstname:he,lastname:Me,username:Pe,preferedLanguage:Oe,currentTheme:L,confirmPassword:"",password:""};return(0,e.jsxs)(I.o,{"aria-busy":ue,children:[(0,e.jsx)(Z.q,{title:o({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),(0,e.jsx)(Y.J9,{onSubmit:fe,initialValues:De,validateOnChange:!1,validationSchema:se,enableReinitialize:!0,children:({errors:a,values:{email:h,firstname:p,lastname:E,username:f,preferedLanguage:S,currentTheme:B,password:Le,confirmPassword:ve},handleChange:W,isSubmitting:xe,dirty:Ae})=>(0,e.jsxs)(i.Form,{children:[(0,e.jsx)(T.T,{title:v.username||(0,G.g)(v.firstname??"",v.lastname),primaryAction:(0,e.jsx)(M.z,{startIcon:(0,e.jsx)(V.Z,{}),loading:xe,type:"submit",disabled:!Ae,children:o({id:"global.save",defaultMessage:"Save"})})}),(0,e.jsx)(m.x,{paddingBottom:10,children:(0,e.jsx)(j.D,{children:(0,e.jsxs)(_.k,{direction:"column",alignItems:"stretch",gap:6,children:[(0,e.jsx)(re,{errors:a,onChange:W,values:{firstname:p,lastname:E,username:f,email:h}}),!pe&&(0,e.jsx)(te,{errors:a,onChange:W,values:{password:Le,confirmPassword:ve}}),(0,e.jsx)(ne,{allApplicationThemes:oe,onChange:W,values:{preferedLanguage:S,currentTheme:B},localeNames:l})]})})})]})})]})},te=({errors:t,onChange:l,values:c})=>{const{formatMessage:o}=(0,C.Z)(),[n,u]=d.useState(!1),[r,O]=d.useState(!1);return(0,e.jsx)(m.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(_.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(y.Z,{variant:"delta",as:"h2",children:o({id:"global.change-password",defaultMessage:"Change password"})}),(0,e.jsxs)(R.r,{gap:5,children:[(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)($,{error:t.password?o({id:t.password,defaultMessage:t.password}):"",onChange:l,value:c.password,label:o({id:"global.password",defaultMessage:"Password"}),name:"password",type:n?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(b,{onClick:D=>{D.stopPropagation(),u(L=>!L)},label:o(n?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:n?(0,e.jsx)(K.Z,{}):(0,e.jsx)(w.Z,{})})})}),(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)($,{error:t.confirmPassword?o({id:t.confirmPassword,defaultMessage:t.confirmPassword}):"",onChange:l,value:c.confirmPassword,label:o({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:r?"text":"password",autoComplete:"new-password",endAction:(0,e.jsx)(b,{onClick:D=>{D.stopPropagation(),O(L=>!L)},label:o(r?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:r?(0,e.jsx)(K.Z,{}):(0,e.jsx)(w.Z,{})})})})]})]})})},$=(0,F.default)(X.o)`
  ::-ms-reveal {
    display: none;
  }
`,b=(0,F.default)(J.E)`
  svg {
    height: ${(0,i.pxToRem)(16)};
    width: ${(0,i.pxToRem)(16)};
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,ne=({onChange:t,values:l,localeNames:c,allApplicationThemes:o={}})=>{const{formatMessage:n}=(0,C.Z)(),u=Object.keys(o).filter(r=>o[r]);return(0,e.jsx)(m.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(_.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsxs)(_.k,{direction:"column",alignItems:"stretch",gap:1,children:[(0,e.jsx)(y.Z,{variant:"delta",as:"h2",children:n({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})}),(0,e.jsx)(y.Z,{children:n({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:(0,e.jsx)(m.x,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales",children:n({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"})})})})]}),(0,e.jsxs)(R.r,{gap:5,children:[(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)(P.q4,{label:n({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:n({id:"global.select",defaultMessage:"Select"}),hint:n({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{t({target:{name:"preferedLanguage",value:null}})},clearLabel:n({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:l.preferedLanguage,onChange:r=>{t({target:{name:"preferedLanguage",value:r}})},children:Object.entries(c).map(([r,O])=>(0,e.jsx)(P.ag,{value:r,children:O},r))})}),(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsxs)(P.q4,{label:n({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:n({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:n({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:l.currentTheme,onChange:r=>{t({target:{name:"currentTheme",value:r}})},children:[(0,e.jsx)(P.ag,{value:"system",children:n({id:"Settings.profile.form.section.experience.mode.option-system-label",defaultMessage:"Use system settings"})}),u.map(r=>(0,e.jsx)(P.ag,{value:r,children:n({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:n({id:r,defaultMessage:k(r)})})},r))]})})]})]})})},re=({errors:t,onChange:l,values:c})=>{const{formatMessage:o}=(0,C.Z)();return(0,e.jsx)(m.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,e.jsxs)(_.k,{direction:"column",alignItems:"stretch",gap:4,children:[(0,e.jsx)(y.Z,{variant:"delta",as:"h2",children:o({id:"global.profile",defaultMessage:"Profile"})}),(0,e.jsxs)(R.r,{gap:5,children:[(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:t.firstname,onChange:l,value:c.firstname,type:"text",name:"firstname",required:!0})}),(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:t.lastname,onChange:l,value:c.lastname,type:"text",name:"lastname"})}),(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:t.email,onChange:l,value:c.email,type:"email",name:"email",required:!0})}),(0,e.jsx)(g.P,{s:12,col:6,children:(0,e.jsx)(i.GenericInput,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:t.username,onChange:l,value:c.username,type:"text",name:"username"})})]})]})})}},8291:(Q,x,s)=>{s.d(x,{a:()=>j,s:()=>I});var e=s(47853),d=s(1180);const A={firstname:e.Z_().trim().required(d.translatedErrors.required),lastname:e.Z_(),email:e.Z_().email(d.translatedErrors.email).lowercase().required(d.translatedErrors.required),username:e.Z_().nullable(),password:e.Z_().min(8,d.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Z_().min(8,d.translatedErrors.minLength).oneOf([e.iH("password"),null],"components.Input.error.password.noMatch").when("password",(M,m)=>M?m.required(d.translatedErrors.required):m)},I={...A,currentPassword:e.Z_().when(["password","confirmPassword"],(M,m,_)=>M||m?_.required(d.translatedErrors.required):_),preferedLanguage:e.Z_().nullable()},T={roles:e.IX().min(1,d.translatedErrors.required).required(d.translatedErrors.required)},j=e.Ry().shape({...A,isActive:e.Xg(),...T})}}]);
